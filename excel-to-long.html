<!DOCTYPE html>
<html>
<head>
    <title>Excel to Long Format - Tim Hilirisasi 3</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            background: linear-gradient(135deg, #01267F 0%, #001a4d 100%);
            color: white;
            min-height: 100vh;
            display: flex;
        }
        
        /* ===== NAVIGATION PANE ===== */
        .sidebar {
            width: 280px;
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-header {
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }
        
        .sidebar-title {
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .sidebar-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9em;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 8px;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            display: block;
            padding: 10px 15px;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.95em;
            border-left: 3px solid transparent;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .nav-link.active {
            background: rgba(1, 38, 127, 0.5);
            color: white;
            border-left: 3px solid #4CAF50;
        }
        
        .nav-section {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 25px 0 10px 15px;
        }
        
        /* ===== MAIN CONTENT ===== */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-width: calc(100% - 280px);
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px 40px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            width: 50px;
            height: 50px;
            background: #01267F;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .title-section h1 {
            color: #01267F;
            font-size: 1.8em;
            margin-bottom: 5px;
        }
        
        .title-section p {
            color: #666;
            font-size: 1em;
        }
        
        .back-button {
            background: #01267F;
            color: white;
            padding: 12px 25px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1em;
            white-space: nowrap;
        }
        
        .back-button:hover {
            background: #001a4d;
            transform: translateY(-2px);
        }
        
        /* ===== SLIDE STYLES ===== */
        .slide-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 35px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            color: #01267F;
            scroll-margin-top: 20px;
        }
        
        .slide-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #01267F;
        }
        
        .slide-number {
            background: #01267F;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            flex-shrink: 0;
        }
        
        .slide-title {
            font-size: 1.6em;
            font-weight: bold;
            color: #01267F;
            margin-left: 15px;
            flex-grow: 1;
        }
        
        .slide-content {
            line-height: 1.7;
            font-size: 1.05em;
        }
        
        .slide-content ol, .slide-content ul {
            margin-left: 25px;
            margin-bottom: 20px;
        }
        
        .slide-content li {
            margin-bottom: 12px;
            padding-left: 5px;
        }
        
        .image-container {
            width: 100%;
            max-width: 900px;
            margin: 25px auto;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: #f8f9fa;
        }
        
        .image-container img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .image-caption {
            text-align: center;
            color: #666;
            font-style: italic;
            margin-top: 8px;
            font-size: 0.95em;
        }
        
        /* ===== ALERT BOXES ===== */
        .alert-box {
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid;
        }
        
        .alert-info {
            background: #e3f2fd;
            border-left-color: #2196F3;
        }
        
        .alert-warning {
            background: #fff3e0;
            border-left-color: #ff9800;
        }
        
        .alert-success {
            background: #e8f5e9;
            border-left-color: #4CAF50;
        }
        
        .alert-box h4 {
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        /* ===== QUICK TIPS ===== */
        .quick-tips {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
            border: 1px solid #e0e0e0;
        }
        
        .quick-tips h4 {
            color: #01267F;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ===== TABLES ===== */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        
        .data-table th {
            background: #01267F;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .data-table td {
            padding: 10px;
            border: 1px solid #ddd;
            color: #333;
        }
        
        .data-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        /* ===== CODE BLOCKS ===== */
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .code-comment {
            color: #75715e;
        }
        
        .code-function {
            color: #66d9ef;
        }
        
        .code-string {
            color: #e6db74;
        }
        
        .code-number {
            color: #ae81ff;
        }
        
        /* ===== METHOD CARDS ===== */
        .method-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .method-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }
        
        .method-card:hover {
            border-color: #01267F;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .method-card h4 {
            color: #01267F;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ===== NAVIGATION BUTTONS ===== */
        .slide-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .nav-button {
            background: #01267F;
            color: white;
            padding: 12px 25px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1em;
        }
        
        .nav-button:hover {
            background: #001a4d;
            transform: translateY(-2px);
        }
        
        /* ===== FOOTER ===== */
        .footer {
            text-align: center;
            padding: 30px 20px;
            background: rgba(0, 0, 0, 0.2);
            margin-top: 50px;
            border-radius: 12px;
        }
        
        .footer p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95em;
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 1024px) {
            body {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                max-height: 300px;
            }
            
            .main-content {
                max-width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .slide-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .slide-title {
                margin-left: 0;
                text-align: center;
            }
            
            .slide-navigation {
                flex-direction: column;
                gap: 10px;
            }
            
            .nav-button {
                width: 100%;
                text-align: center;
            }
            
            .method-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- ===== NAVIGATION PANE ===== -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">üìä Excel to Long Format</div>
            <div class="sidebar-subtitle">Tim Hilirisasi 3 - Bappenas</div>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-section">A. KONSEP FORMAT LONG</li>
            <li class="nav-item"><a href="#section-1" class="nav-link active">1. Apa itu Format Long?</a></li>
            <li class="nav-item"><a href="#section-2" class="nav-link">2. Keuntungan Format Long</a></li>
            <li class="nav-item"><a href="#section-3" class="nav-link">3. Struktur Data Long</a></li>
            
            <li class="nav-section">B. METODE KONVERSI</li>
            <li class="nav-item"><a href="#section-4" class="nav-link">4. Power Query (Rekomendasi)</a></li>
            <li class="nav-item"><a href="#section-5" class="nav-link">5. PivotTable Method</a></li>
            <li class="nav-item"><a href="#section-6" class="nav-link">6. VBA Macro</a></li>
            
            <li class="nav-section">C. PRAKTIKUM</li>
            <li class="nav-item"><a href="#section-7" class="nav-link">7. Contoh Data Wide</a></li>
            <li class="nav-item"><a href="#section-8" class="nav-link">8. Step-by-Step Konversi</a></li>
            <li class="nav-item"><a href="#section-9" class="nav-link">9. Validasi Hasil</a></li>
            
            <li class="nav-section">D. TIPS & OPTIMASI</li>
            <li class="nav-item"><a href="#section-10" class="nav-link">10. Best Practices</a></li>
            <li class="nav-item"><a href="#section-11" class="nav-link">11. Troubleshooting</a></li>
            <li class="nav-item"><a href="#section-12" class="nav-link">12. Template Siap Pakai</a></li>
        </ul>
        
        <div style="margin-top: 30px; padding: 15px; background: rgba(1, 38, 127, 0.1); border-radius: 8px;">
            <div style="font-weight: bold; color: white; margin-bottom: 8px;">üéØ Output Format</div>
            <div style="font-size: 0.9em; color: rgba(255, 255, 255, 0.8);">
                ID | Variable | Value | Metadata
            </div>
        </div>
    </nav>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="main-content">
        <!-- HEADER -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
            	<img src="Tim H3 (1).png" 
     		alt="Logo Tim Hilirisasi 3" 
     		class="logo-real" 
    		style="width: 54px; height: auto;">
                    <div class="title-section">
                        <h1>Panduan: Excel ke Format Long</h1>
                        <p>Konversi data tabel ke struktur database untuk analisis</p>
                    </div>
                </div>
                <a href="panduan-teknis.html" class="back-button">üìö Menu Panduan</a>
                <a href="index.html" class="back-button">üè† Menu Utama</a>
            </div>
        </header>

        <!-- INTRODUCTION -->
        <div class="slide-container">
            <div class="slide-content">
                <h3 style="color: #01267F; text-align: center; margin-bottom: 20px;">üéØ Transformasi Data Tabel ke Database</h3>
                <p style="text-align: center; margin-bottom: 25px;">Format long optimal untuk analisis statistik, machine learning, dan data warehousing.</p>
                
                <div class="method-cards">
                    <div class="method-card">
                        <h4>üìä Data Wide (Before)</h4>
                        <p>Struktur tabel tradisional:<br>
                        <code>ID | Year | Var1 | Var2 | Var3</code></p>
                        <p><strong>Untuk:</strong> Laporan, presentasi</p>
                    </div>
                    
                    <div class="method-card">
                        <h4>üîÑ Proses Konversi</h4>
                        <p>3 metode utama:<br>
                        ‚Ä¢ Power Query (recommended)<br>
                        ‚Ä¢ PivotTable<br>
                        ‚Ä¢ VBA Macro</p>
                        <p><strong>Waktu:</strong> 5-15 menit</p>
                    </div>
                    
                    <div class="method-card">
                        <h4>üìà Data Long (After)</h4>
                        <p>Struktur database:<br>
                        <code>ID | Year | Variable | Value</code></p>
                        <p><strong>Untuk:</strong> Analisis, statistik, ML</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 1: APA ITU FORMAT LONG ===== -->
        <div id="section-1" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">1</div>
                <div class="slide-title">Apa itu Format Long (Tidy Data)?</div>
            </div>
            <div class="slide-content">
                <h4>üìê Konsep Tidy Data:</h4>
                <p>Format long mengikuti prinsip <strong>"tidy data"</strong> yang dikembangkan oleh Hadley Wickham:</p>
                
                <div style="background: #f9f9f9; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #01267F; margin-bottom: 15px;">üéØ 3 Prinsip Tidy Data:</h4>
                    <ol>
                        <li><strong>Setiap variabel satu kolom</strong><br>
                        Setiap kolom mewakili satu variabel/atribut</li>
                        <li><strong>Setiap observasi satu baris</strong><br>
                        Setiap baris mewakili satu unit observasi</li>
                        <li><strong>Setiap nilai satu cell</strong><br>
                        Tidak ada multiple values dalam satu cell</li>
                    </ol>
                </div>
                
                <div class="image-container">
                    <img src="C:\Users\mikha\Mikel\Web\pdf-to-excel_gambar\Excel_Long_Concept.png" alt="Konsep Format Long">
                    <div class="image-caption">Gambar 1: Perbandingan format wide vs long</div>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 2: KEUNTUNGAN FORMAT LONG ===== -->
        <div id="section-2" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">2</div>
                <div class="slide-title">Keuntungan Menggunakan Format Long</div>
            </div>
            <div class="slide-content">
                <h4>‚úÖ Mengapa Harus Convert ke Long?</h4>
                
                <div class="method-cards">
                    <div class="method-card">
                        <h4>üìà Analisis Statistik</h4>
                        <ul style="margin-top: 10px;">
                            <li>Mudah untuk regression</li>
                            <li>Cocok untuk ANOVA</li>
                            <li>Time series analysis</li>
                            <li>Panel data analysis</li>
                        </ul>
                    </div>
                    
                    <div class="method-card">
                        <h4>ü§ñ Machine Learning</h4>
                        <ul style="margin-top: 10px;">
                            <li>Input format standard</li>
                            <li>Feature engineering mudah</li>
                            <li>Compatible dengan semua library</li>
                            <li>Scalable untuk big data</li>
                        </ul>
                    </div>
                    
                    <div class="method-card">
                        <h4>üóÑÔ∏è Data Management</h4>
                        <ul style="margin-top: 10px;">
                            <li>Easy to merge datasets</li>
                            <li>Simple to update data</li>
                            <li>Efficient storage</li>
                            <li>Version control friendly</li>
                        </ul>
                    </div>
                </div>
                
                <div class="alert-box alert-success">
                    <h4>üéØ Contoh Penggunaan Format Long:</h4>
                    <p><strong>Data Keuangan:</strong> ID | Year | Account | Amount<br>
                    <strong>Data Produksi:</strong> ID | Month | Product | Quantity<br>
                    <strong>Data Survey:</strong> ID | Question | Response | Score<br>
                    <strong>Data Sensor:</strong> ID | Timestamp | Sensor | Reading</p>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 3: STRUKTUR DATA LONG ===== -->
        <div id="section-3" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">3</div>
                <div class="slide-title">Struktur Database Long Format</div>
            </div>
            <div class="slide-content">
                <h4>üèóÔ∏è Template Database Long:</h4>
                
                <div style="background: #f0f8ff; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #1565c0;">üìã Kolom Wajib Format Long:</h4>
                    <table class="data-table">
                        <tr>
                            <th>Kolom</th>
                            <th>Contoh Nama</th>
                            <th>Tipe Data</th>
                            <th>Keterangan</th>
                        </tr>
                        <tr>
                            <td>Primary Key</td>
                            <td>ID, Unit_ID, Company_ID</td>
                            <td>Text/Number</td>
                            <td>Identifier unik</td>
                        </tr>
                        <tr>
                            <td>Variable</td>
                            <td>Variable, Metric, Indicator</td>
                            <td>Text</td>
                            <td>Nama variabel/measure</td>
                        </tr>
                        <tr>
                            <td>Value</td>
                            <td>Value, Amount, Quantity</td>
                            <td>Number</td>
                            <td>Nilai data</td>
                        </tr>
                        <tr>
                            <td>Time Dimension</td>
                            <td>Year, Month, Date, Period</td>
                            <td>Date/Number</td>
                            <td>Dimensi waktu (opsional)</td>
                        </tr>
                    </table>
                </div>
                
                <div class="image-container">
                    <img src="C:\Users\mikha\Mikel\Web\pdf-to-excel_gambar\Excel_Long_Structure.png" alt="Struktur Format Long">
                    <div class="image-caption">Gambar 2: Template database format long</div>
                </div>
                
                <div class="quick-tips">
                    <h4>üîß Tips Penamaan Kolom:</h4>
                    <ul>
                        <li>Gunakan nama yang deskriptif</li>
                        <li>Konsisten untuk semua dataset</li>
                        <li>Hindari spasi (gunakan underscore)</li>
                        <li>Case sensitive: pilih salah satu (ALL_CAPS atau camelCase)</li>
                        <li>Tambahkan metadata kolom di sheet terpisah</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 4: POWER QUERY METHOD ===== -->
        <div id="section-4" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">4</div>
                <div class="slide-title">Metode 1: Power Query (Rekomendasi)</div>
            </div>
            <div class="slide-content">
                <h4>‚ö° Step-by-Step Power Query Unpivot:</h4>
                
                <div style="background: #e8f5e9; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #2e7d32;">üìã Langkah-langkah:</h4>
                    <ol>
                        <li><strong>Select data range</strong> di Excel (Ctrl+A)</li>
                        <li><strong>Data tab</strong> ‚Üí Get Data ‚Üí From Table/Range</li>
                        <li><strong>Power Query Editor</strong> akan terbuka</li>
                        <li><strong>Select kolom ID/key</strong> (tidak akan di-unpivot)</li>
                        <li><strong>Transform tab</strong> ‚Üí Unpivot Columns ‚Üí Unpivot Other Columns</li>
                        <li><strong>Rename columns:</strong> Attribute ‚Üí Variable, Value ‚Üí Value</li>
                        <li><strong>Optional:</strong> Ubah data type kolom Value ke Number</li>
                        <li><strong>Home tab</strong> ‚Üí Close & Load</li>
                    </ol>
                </div>
                
                <div class="image-container">
                    <img src="C:\Users\mikha\Mikel\Web\pdf-to-excel_gambar\PowerQuery_Steps.png" alt="Power Query Steps">
                    <div class="image-caption">Gambar 3: Proses Unpivot di Power Query Editor</div>
                </div>
                
                <div class="alert-box alert-info">
                    <h4>üí° Keuntungan Power Query:</h4>
                    <p>‚Ä¢ <strong>Refreshable</strong> - update otomatis saat data source berubah<br>
                    ‚Ä¢ <strong>Repeatable</strong> - bisa digunakan untuk multiple files<br>
                    ‚Ä¢ <strong>Scalable</strong> - handle data besar dengan baik<br>
                    ‚Ä¢ <strong>Customizable</strong> - bisa ditambah step transformasi lain</p>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 5: PIVOT TABLE METHOD ===== -->
        <div id="section-5" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">5</div>
                <div class="slide-title">Metode 2: PivotTable Multiple Consolidation</div>
            </div>
            <div class="slide-content">
                <h4>üìä Untuk Excel tanpa Power Query:</h4>
                
                <div style="background: #fff3e0; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #ff8f00;">üìã Langkah PivotTable:</h4>
                    <ol>
                        <li><strong>Select data range</strong> yang akan di-convert</li>
                        <li><strong>Tekan Alt + D + P</strong> (PivotTable Wizard)</li>
                        <li><strong>Pilih:</strong> "Multiple consolidation ranges" ‚Üí Next</li>
                        <li><strong>Pilih:</strong> "I will create the page fields" ‚Üí Next</li>
                        <li><strong>Add range</strong> data Anda ‚Üí Next</li>
                        <li><strong>Pilih lokasi:</strong> New worksheet ‚Üí Finish</li>
                        <li><strong>PivotTable akan muncul</strong> dengan format khusus</li>
                        <li><strong>Double klik</strong> pada grand total cell</li>
                        <li><strong>Data detail akan muncul</strong> di sheet baru (format long)</li>
                    </ol>
                </div>
                
                <div class="image-container">
                    <img src="C:\Users\mikha\Mikel\Web\pdf-to-excel_gambar\PivotTable_Method.png" alt="PivotTable Method">
                    <div class="image-caption">Gambar 4: PivotTable Multiple Consolidation</div>
                </div>
                
                <div class="alert-box alert-warning">
                    <h4>‚ö†Ô∏è Batasan Metode Ini:</h4>
                    <p>‚Ä¢ Maksimal 8 page fields<br>
                    ‚Ä¢ Tidak bisa handle blank headers<br>
                    ‚Ä¢ Tidak otomatis refresh<br>
                    ‚Ä¢ Terbatas untuk data sederhana<br>
                    ‚Ä¢ Excel 2010+ sudah ada Power Query (lebih baik)</p>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 6: VBA MACRO METHOD ===== -->
        <div id="section-6" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">6</div>
                <div class="slide-title">Metode 3: VBA Macro untuk Batch Processing</div>
            </div>
            <div class="slide-content">
                <h4>ü§ñ Macro untuk Multiple Files:</h4>
                
                <div class="code-block">
<span class="code-comment">' VBA Macro untuk Convert Wide ke Long Format</span>
<span class="code-function">Sub</span> ConvertWideToLong()
    <span class="code-comment">' Deklarasi variabel</span>
    <span class="code-function">Dim</span> wsSource <span class="code-function">As</span> Worksheet, wsTarget <span class="code-function">As</span> Worksheet
    <span class="code-function">Dim</span> lastRow <span class="code-function">As</span> Long, lastCol <span class="code-function">As</span> Long
    <span class="code-function">Dim</span> i <span class="code-function">As</span> Long, j <span class="code-function">As</span> Long, k <span class="code-function">As</span> Long
    
    <span class="code-comment">' Set worksheets (sesuaikan dengan nama sheet Anda)</span>
    <span class="code-function">Set</span> wsSource = ThisWorkbook.Sheets("<span class="code-string">Data_Wide</span>")
    <span class="code-function">Set</span> wsTarget = ThisWorkbook.Sheets.Add
    wsTarget.Name = "<span class="code-string">Data_Long_</span>" & Format(Now, "yyyymmdd_hhmm")
    
    <span class="code-comment">' Cari range data</span>
    lastRow = wsSource.Cells(wsSource.Rows.Count, 1).End(xlUp).Row
    lastCol = wsSource.Cells(1, wsSource.Columns.Count).End(xlToLeft).Column
    
    <span class="code-comment">' Buat header di sheet target</span>
    wsTarget.Cells(1, 1).Value = "<span class="code-string">ID</span>"
    wsTarget.Cells(1, 2).Value = "<span class="code-string">Variable</span>"
    wsTarget.Cells(1, 3).Value = "<span class="code-string">Value</span>"
    <span class="code-comment">' Tambah metadata jika perlu</span>
    wsTarget.Cells(1, 4).Value = "<span class="code-string">Year</span>"
    
    <span class="code-comment">' Proses konversi (asumsi: kolom 1 = ID, kolom 2 = Year, kolom 3+ = variables)</span>
    k = 2  <span class="code-comment">' Start row di sheet target</span>
    <span class="code-function">For</span> i = 2 <span class="code-function">To</span> lastRow  <span class="code-comment">' Skip header row</span>
        <span class="code-function">For</span> j = 3 <span class="code-function">To</span> lastCol  <span class="code-comment">' Start dari kolom variable pertama</span>
            <span class="code-function">If</span> Not IsEmpty(wsSource.Cells(i, j)) <span class="code-function">Then</span>
                <span class="code-comment">' ID</span>
                wsTarget.Cells(k, 1).Value = wsSource.Cells(i, 1).Value
                <span class="code-comment">' Variable name (dari header)</span>
                wsTarget.Cells(k, 2).Value = wsSource.Cells(1, j).Value
                <span class="code-comment">' Value</span>
                wsTarget.Cells(k, 3).Value = wsSource.Cells(i, j).Value
                <span class="code-comment">' Metadata: Year</span>
                wsTarget.Cells(k, 4).Value = wsSource.Cells(i, 2).Value
                k = k + 1
            <span class="code-function">End If</span>
        <span class="code-function">Next</span> j
    <span class="code-function">Next</span> i
    
    <span class="code-comment">' Format sebagai Table Excel</span>
    wsTarget.ListObjects.Add(xlSrcRange, wsTarget.Range("A1").CurrentRegion, , xlYes).Name = "tblLongData"
    
    <span class="code-comment">' Pesan sukses</span>
    MsgBox "Konversi selesai!" & vbNewLine & _
           "Total rows: " & (k - 2) & vbNewLine & _
           "File saved as: " & wsTarget.Name, vbInformation
<span class="code-function">End Sub</span>
                </div>
                
                <div class="quick-tips">
                    <h4>üöÄ Cara Menggunakan Macro:</h4>
                    <ol>
                        <li><strong>Alt + F11</strong> untuk buka VBA Editor</li>
                        <li><strong>Insert ‚Üí Module</strong></li>
                        <li><strong>Copy paste</strong> code di atas</li>
                        <li><strong>Customize</strong> sesuai struktur data Anda</li>
                        <li><strong>Save</strong> file sebagai .xlsm (macro-enabled)</li>
                        <li><strong>Run</strong> dari Developer tab atau Alt + F8</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 7: CONTOH DATA WIDE ===== -->
        <div id="section-7" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">7</div>
                <div class="slide-title">Contoh Data Wide Sebelum Konversi</div>
            </div>
            <div class="slide-content">
                <h4>üìä Contoh Struktur Data Wide:</h4>
                
                <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #01267F;">üè¢ Data Produksi Perusahaan (Wide Format)</h4>
                    <table class="data-table">
                        <tr>
                            <th>Company_ID</th>
                            <th>Year</th>
                            <th>Revenue</th>
                            <th>Cost</th>
                            <th>Profit</th>
                            <th>Employees</th>
                            <th>Production</th>
                        </tr>
                        <tr>
                            <td>COMP001</td>
                            <td>2022</td>
                            <td>1,000,000</td>
                            <td>600,000</td>
                            <td>400,000</td>
                            <td>50</td>
                            <td>10,000</td>
                        </tr>
                        <tr>
                            <td>COMP001</td>
                            <td>2023</td>
                            <td>1,200,000</td>
                            <td>700,000</td>
                            <td>500,000</td>
                            <td>55</td>
                            <td>12,000</td>
                        </tr>
                        <tr>
                            <td>COMP002</td>
                            <td>2022</td>
                            <td>800,000</td>
                            <td>500,000</td>
                            <td>300,000</td>
                            <td>30</td>
                            <td>8,000</td>
                        </tr>
                        <tr>
                            <td>COMP002</td>
                            <td>2023</td>
                            <td>900,000</td>
                            <td>550,000</td>
                            <td>350,000</td>
                            <td>35</td>
                            <td>9,000</td>
                        </tr>
                    </table>
                    <p style="margin-top: 10px; font-style: italic;">Format wide: satu baris per observasi, banyak kolom variabel</p>
                </div>
                
                <div class="alert-box alert-info">
                    <h4>üîç Identifikasi Data Wide:</h4>
                    <p><strong>Ciri-ciri data wide:</strong><br>
                    ‚Ä¢ Satu baris = satu observasi lengkap<br>
                    ‚Ä¢ Banyak kolom = banyak variabel<br>
                    ‚Ä¢ Mudah dibaca manusia<br>
                    ‚Ä¢ Cocok untuk laporan tabel<br>
                    ‚Ä¢ <em>Tidak ideal untuk analisis statistik</em></p>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 8: STEP-BY-STEP KONVERSI ===== -->
        <div id="section-8" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">8</div>
                <div class="slide-title">Step-by-Step Konversi dengan Power Query</div>
            </div>
            <div class="slide-content">
                <h4>üîß Tutorial Praktis:</h4>
                
                <div style="background: #e3f2fd; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #1565c0;">üìã Langkah Detail Power Query:</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                        <div>
                            <h5>Step 1: Prepare Data</h5>
                            <ol>
                                <li>Pastikan data punya header yang jelas</li>
                                <li>Identifikasi kolom ID/key</li>
                                <li>Identifikasi kolom metadata (tahun, periode)</li>
                                <li>Identifikasi kolom variable yang akan di-unpivot</li>
                                <li>Bersihkan data jika perlu</li>
                            </ol>
                        </div>
                        
                        <div>
                            <h5>Step 2: Load ke Power Query</h5>
                            <ol>
                                <li>Select seluruh data range</li>
                                <li>Data ‚Üí From Table/Range</li>
                                <li>Tick "My table has headers"</li>
                                <li>Klik OK</li>
                                <li>Power Query Editor terbuka</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div>
                            <h5>Step 3: Unpivot Columns</h5>
                            <ol>
                                <li>Select kolom Company_ID dan Year</li>
                                <li>Klik kanan ‚Üí Unpivot Other Columns</li>
                                <li>Atau: Transform ‚Üí Unpivot Columns</li>
                                <li>Kolom baru: Attribute dan Value muncul</li>
                                <li>Rename: Attribute ‚Üí Variable</li>
                            </ol>
                        </div>
                        
                        <div>
                            <h5>Step 4: Finalize</h5>
                            <ol>
                                <li>Ubah data type kolom Value ke Decimal Number</li>
                                <li>Optional: Sort data jika perlu</li>
                                <li>Home ‚Üí Close & Load</li>
                                <li>Pilih: Load to New Worksheet</li>
                                <li>Data long siap digunakan!</li>
                            </ol>
                        </div>
                    </div>
                </div>
                
                <div class="image-container">
                    <img src="C:\Users\mikha\Mikel\Web\pdf-to-excel_gambar\Excel_Conversion_Steps.png" alt="Step-by-Step Conversion">
                    <div class="image-caption">Gambar 5: Proses konversi step-by-step</div>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 9: VALIDASI HASIL ===== -->
        <div id="section-9" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">9</div>
                <div class="slide-title">Validasi Data Hasil Konversi</div>
            </div>
            <div class="slide-content">
                <h4>‚úÖ Checklist Validasi Format Long:</h4>
                
                <div style="background: #f0f8ff; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #1565c0;">üìã Checklist Quality Assurance:</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #ddd;">
                            <h5>üî¢ Data Integrity</h5>
                            <ul>
                                <li>Total nilai tidak berubah</li>
                                <li>Jumlah observasi konsisten</li>
                                <li>No data loss setelah convert</li>
                                <li>Consistency check passed</li>
                            </ul>
                        </div>
                        
                        <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #ddd;">
                            <h5>üìä Structure Check</h5>
                            <ul>
                                <li>3+ kolom (ID, Variable, Value)</li>
                                <li>Variable names konsisten</li>
                                <li>Data types sesuai</li>
                                <li>No merge cells</li>
                            </ul>
                        </div>
                        
                        <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #ddd;">
                            <h5>üéØ Usability Check</h5>
                            <ul>
                                <li>Bisa pivot dengan mudah</li>
                                <li>Filter berfungsi normal</li>
                                <li>Sorting bekerja baik</li>
                                <li>Export ke software lain OK</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="quick-tips">
                    <h4>üîç Cara Validasi Manual:</h4>
                    <table class="data-table">
                        <tr>
                            <th>Test</th>
                            <th>Cara Test</th>
                            <th>Expected Result</th>
                        </tr>
                        <tr>
                            <td>Total Check</td>
                            <td>SUM data wide vs SUM data long</td>
                            <td>Sama persis</td>
                        </tr>
                        <tr>
                            <td>Count Check</td>
                            <td>COUNT unique combinations</td>
                            <td>ID √ó Variables = Rows</td>
                        </tr>
                        <tr>
                            <td>Pivot Test</td>
                            <td>Buat PivotTable dari data long</td>
                            <td>Bisa recreate data wide</td>
                        </tr>
                        <tr>
                            <td>Export Test</td>
                            <td>Export ke CSV/Stata/R</td>
                            <td>Format terbaca baik</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 10: BEST PRACTICES ===== -->
        <div id="section-10" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">10</div>
                <div class="slide-title">Best Practices & Tips</div>
            </div>
            <div class="slide-content">
                <h4>üåü Tips Profesional:</h4>
                
                <div class="method-cards">
                    <div class="method-card">
                        <h4>üìÅ File Organization</h4>
                        <ul style="margin-top: 10px;">
                            <li>Simpan data wide asli sebagai backup</li>
                            <li>Beri nama file jelas: _WIDE dan _LONG</li>
                            <li>Gunakan version control (v01, v02)</li>
                            <li>Simpan query Power Query terpisah</li>
                        </ul>
                    </div>
                    
                    <div class="method-card">
                        <h4>üîß Performance Tips</h4>
                        <ul style="margin-top: 10px;">
                            <li>Untuk data besar, gunakan Power Pivot</li>
                            <li>Disable auto calculation saat proses</li>
                            <li>Gunakan Data Model untuk >1M rows</li>
                            <li>Optimasi dengan removing blanks early</li>
                        </ul>
                    </div>
                    
                    <div class="method-card">
                        <h4>üé® Data Quality</h4>
                        <ul style="margin-top: 10px;">
                            <li>Standardize variable names sebelum convert</li>
                            <li>Handle missing values dengan konsisten</li>
                            <li>Validasi data type sebelum/ sesudah</li>
                            <li>Buat data dictionary untuk metadata</li>
                        </ul>
                    </div>
                </div>
                
                <div class="alert-box alert-success">
                    <h4>‚úÖ Checklist Sebelum Konversi:</h4>
                    <ol>
                        <li><strong>Backup data original</strong> (jangan edit langsung)</li>
                        <li><strong>Clean data</strong> (remove duplicates, fix formats)</li>
                        <li><strong>Standardize headers</strong> (no spaces, consistent case)</li>
                        <li><strong>Identify key columns</strong> (ID, time dimensions)</li>
                        <li><strong>Plan metadata</strong> (tambahkan kolom metadata setelah convert)</li>
                        <li><strong>Test dengan sample kecil</strong> sebelum full dataset</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 11: TROUBLESHOOTING ===== -->
        <div id="section-11" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">11</div>
                <div class="slide-title">Troubleshooting Common Issues</div>
            </div>
            <div class="slide-content">
                <h4>üîß Solusi Masalah Umum:</h4>
                
                <div style="background: #ffebee; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #c62828;">‚ùå Common Errors & Solutions:</h4>
                    <table class="data-table">
                        <tr>
                            <th>Masalah</th>
                            <th>Penyebab</th>
                            <th>Solusi</th>
                        </tr>
                        <tr>
                            <td>Number jadi text</td>
                            <td>Format cell, karakter khusus</td>
                            <td>Power Query: Change Type ‚Üí Number</td>
                        </tr>
                        <tr>
                            <td>Missing data setelah convert</td>
                            <td>Blank cells, filter aktif</td>
                            <td>Include blanks, remove filters</td>
                        </tr>
                        <tr>
                            <td>Variable names tidak konsisten</td>
                            <td>Typo, case sensitivity</td>
                            <td>Standardize sebelum convert</td>
                        </tr>
                        <tr>
                            <td>Excel crash/hang</td>
                            <td>Data terlalu besar</td>
                            <td>Use Power Pivot/Data Model</td>
                        </tr>
                        <tr>
                            <td>Can't unpivot columns</td>
                            <td>Merge cells, blank headers</td>
                            <td>Unmerge, fill headers</td>
                        </tr>
                    </table>
                </div>
                
                <div class="quick-tips">
                    <h4>‚ö° Performance Optimization:</h4>
                    <ul>
                        <li><strong>Large datasets:</strong> Use Power Pivot Data Model (unlimited rows)</li>
                        <li><strong>Slow refresh:</strong> Disable background refresh, manual calculation</li>
                        <li><strong>Memory issues:</strong> Split data, use 64-bit Excel</li>
                        <li><strong>Formula heavy:</strong> Convert formulas to values sebelum convert</li>
                        <li><strong>Network drives:</strong> Copy to local drive sebelum processing</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- ===== SECTION 12: TEMPLATE SIAP PAKAI ===== -->
        <div id="section-12" class="slide-container">
            <div class="slide-header">
                <div class="slide-number">12</div>
                <div class="slide-title">Template & Tools Siap Pakai</div>
            </div>
            <div class="slide-content">
                <h4>üõ†Ô∏è Resources untuk Memudahkan:</h4>
                
                <div style="background: #e8f5e9; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4 style="color: #2e7d32;">üìÅ Download Template:</h4>
                    <div class="method-cards">
                        <div class="method-card">
                            <h4>üìä Excel Template</h4>
                            <p><strong>Fitur:</strong></p>
                            <ul>
                                <li>Pre-built Power Query</li>
                                <li>Auto-refresh capability</li>
                                <li>Data validation rules</li>
                                <li>Example data included</li>
                            </ul>
                            <p style="margin-top: 10px;"><em>Template_Long_Format.xlsx</em></p>
                        </div>
                        
                        <div class="method-card">
                            <h4>ü§ñ VBA Tools</h4>
                            <p><strong>Fitur:</strong></p>
                            <ul>
                                <li>Batch conversion</li>
                                <li>Custom metadata addition</li>
                                <li>Error logging</li>
                                <li>Progress indicator</li>
                            </ul>
                            <p style="margin-top: 10px;"><em>Long_Converter.xlsm</em></p>
                        </div>
                        
                        <div class="method-card">
                            <h4>üìã Data Dictionary</h4>
                            <p><strong>Fitur:</strong></p>
                            <ul>
                                <li>Variable definitions</li>
                                <li>Data type specifications</li>
                                <li>Source information</li>
                                <li>Validation rules</li>
                            </ul>
                            <p style="margin-top: 10px;"><em>Data_Dictionary_Template.xlsx</em></p>
                        </div>
                    </div>
                </div>
                
                <div class="alert-box alert-success">
                    <h4>üéâ Data Long Siap Analisis!</h4>
                    <p>Data Anda sekarang dalam format long yang optimal untuk:</p>
                    <p>‚Ä¢ <strong>Statistical analysis</strong> dengan R, Stata, SPSS<br>
                    ‚Ä¢ <strong>Data visualization</strong> dengan Tableau, Power BI<br>
                    ‚Ä¢ <strong>Machine learning</strong> dengan Python, TensorFlow<br>
                    ‚Ä¢ <strong>Reporting</strong> dengan PivotTables, dashboards<br>
                    ‚Ä¢ <strong>Data sharing</strong> dengan tim/kolaborator</p>
                </div>
                
                <div class="quick-tips">
                    <h4>üîó Langkah Selanjutnya:</h4>
                    <ol>
                        <li><strong>Validasi</strong> data long dengan checklist</li>
                        <li><strong>Tambahkan metadata</strong> jika perlu</li>
                        <li><strong>Simpan backup</strong> data original dan hasil</li>
                        <li><strong>Dokumentasi</strong> proses konversi</li>
                        <li><strong>Share</strong> dengan tim untuk konsistensi</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- FINAL NAVIGATION -->
        <div class="slide-navigation">
            <button class="nav-button" onclick="window.location.href='index.html'">üè† Menu Utama</button>
            <button class="nav-button" onclick="window.location.href='panduan-teknis.html'">üìö Menu Panduan</button>
            <button class="nav-button" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">‚Üë Ke Atas</button>
        </div>

        <!-- FOOTER -->
        <footer class="footer">
            <p>&copy; 2024 Tim Hilirisasi 3 - Dit. PHKEI - Kementerian PPN/Bappenas</p>
            <p style="margin-top: 10px; font-size: 0.9em; color: rgba(255, 255, 255, 0.6);">
                Panduan konversi Excel ke format long untuk analisis statistik
            </p>
        </footer>
    </main>

    <script>
        // Navigation Pane Highlight
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.slide-container');
            
            // Highlight active section in nav
            function highlightNav() {
                let current = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    if (scrollY >= (sectionTop - 200)) {
                        current = section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${current}`) {
                        link.classList.add('active');
                    }
                });
            }
            
            window.addEventListener('scroll', highlightNav);
            
            // Set first nav link as active initially
            navLinks[0].classList.add('active');
        });
        
        // Smooth scroll to sections
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }
        
        // Navigation Pane smooth scroll
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                scrollToSection(targetId);
                
                // Update active state
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>